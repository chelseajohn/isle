<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>isle: Evolvers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script src="striped_bg.js"></script>
<link href="that_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">isle
   &#160;<span id="projectnumber">0.2</span>
   </div>
   <div id="projectbrief">Lattice Monte Carlo for Carbon Nanostructures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('evolversdoc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Evolvers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Evolvers are the main component of HMC evolution. Their task is transforming one configuration into another one along the Markov chain.</p>
<p>All evolvers must inherit from <a class="el" href="classisle_1_1evolver_1_1Evolver.html" title="Abstract base class for evolvers. ">isle.evolver.Evolver</a> and implement the abstract interface.</p><ul>
<li>The <b><code>evolve</code></b> method takes an input configuration <code>phi</code> and conjugate momentum <code>pi</code> and returns a new configuration and momentum.</li>
<li><b><code>save</code></b> stores the current state of the evolver in an HDF5 group so the evolver can be reconstructed by <code>fromH5</code> later and resume evolution.</li>
<li>The classmethod <b><code>fromH5</code></b> constructs a new instance of the evolver from HDF5 based on a state previously written with <code>save</code>.</li>
</ul>
<h3>Evolution</h3>
<p>Evolvers are responsible for almost all of HMC evolution. They have to generate suitable proposals for new configurations and select one all in such a way that reversibility and detailed balance are maintained. Only the generation of the conjugate momenta is handled by the user.</p>
<p>An examples of this is <a class="el" href="classisle_1_1evolver_1_1ConstStepLeapfrog.html" title="A leapfrog evolver with constant parameters. ">isle.evolver.ConstStepLeapfrog</a> which uses leapfrog integration to generate a new <code>phi</code> and <code>pi</code> out of a starting configuration and momentum. Those new fields are either accepted or rejected by <a class="el" href="classisle_1_1evolver_1_1BinarySelector.html" title="Select one of two trajectories based on Metropolis accept/reject. ">isle.evolver.BinarySelector</a> which uses Metropolis accept/reject.</p>
<p>Another example is <a class="el" href="classisle_1_1evolver_1_1TwoPiJumps.html" title="Shift configuration by 2*pi at random lattice sites. ">isle.evolver.TwoPiJumps</a> which generates discrete shifts in the configuration and uses knowledge of the action to compute the change in energy. It can do multiple updates and accept or reject each one individually all encapsulated in one call to <code>evolve</code>.</p>
<h3>Save / Load</h3>
<p>Since evolvers drive HMC evolution, they can in some cases hold state which needs to be handled consistently in order to construct a proper Markov chain. Such state must be recovered when an HMC run is resumed from a checkpoint stored in a file. Evolvers must therefore be able to save their state, or the relevant portions thereof, to HDF5 and retrieve it later. In addition, information on the type of the evolver is stored in a separate location in the file. This allows a run to be continued from just the HDF5 file without any need for additional, user written files.</p>
<h4>Saving Types</h4>
<p>Saving and loading the type of an evolver is handled by <a class="el" href="classisle_1_1evolver_1_1EvolverManager.html" title="Manages evolvers in a file. ">isle.evolver.EvolverManager</a> and the individual evolvers do not have to do anything special to enable this (except for the third point below). An exception to this are collective evolvers such as <a class="el" href="classisle_1_1evolver_1_1Alternator.html" title="Alternate between different evolvers. ">isle.evolver.Alternator</a> which uses an evolver manager to save/load the types of its sub evolvers as part of its state. This is necessary since the manager is unaware of the sub evolvers and cannot handle them when saving/loading the Alternator type.</p>
<p><a class="el" href="classisle_1_1evolver_1_1EvolverManager.html" title="Manages evolvers in a file. ">isle.evolver.EvolverManager</a> supports different ways of saving types in order to accommodate custom evolvers as well as built in ones. There are three scenarios for saving/loading evolver types (see <a class="el" href="filelayout.html">File Layout</a> for more details on how this looks in the file):</p><ul>
<li>The evolver is built into Isle (i.e. defined in module isle.evolver). In this case, reconstructing it is trivial and only its classname is stored in the file (dataset <code>__name__</code>).</li>
<li>The evolver is custom defined but is provided as part of the <code>definitions</code> argument to the constructor of EvolverManager. Again, only the name of the class is stored and there is no visible difference in the HDF5 file.<br />
 The evolver can only be reconstructed if the type is provided to the EvolverManager which reads the file. This can potentially be in a different session and thus requires extra work and care by the user.</li>
<li>The evolver is custom defined and not provided to the manager. In this case, the full source code of the evolver class is saved to the file in the dataset <code>__source__</code> and <code>__name__</code> is set to <code>"__as_source__"</code>. This allows custom evolvers to be reconstructed from file without any additional action by the user. This is used for instance by the program <code>isle continue</code>. <dl class="section attention"><dt>Attention</dt><dd>Evolvers saved this way must be fully self contained, i.e. import any required modules (modules <code>isle</code>, <code>evolvers</code>, and class <code>Evolver</code> are provided and don't have to be imported).</dd></dl>
&#160;</li>
</ul>
<h4>Saving State</h4>
<p>Saving and loading state is the responsibility of the evolvers themselves. The <code>save</code> method is given an HDF5 group for the evolver to do with as it pleases. It must however ensure that calling <code>fromH5</code> with an HDF5 group constructs an evolver that is completely equivalent to the one that was saved, i.e. any observable state must be the same. This is necessary to allow Isle to resume an HMC run.</p>
<p>Evolvers are allowed to issue additional save/load commands through the EvolverManager that is provided to <code>save</code> and <code>fromH5</code>. This can be used to save/load sub evolvers which would otherwise not be visible to the manager. See for example <a class="el" href="classisle_1_1evolver_1_1Alternator.html" title="Alternate between different evolvers. ">isle.evolver.Alternator</a>.</p>
<p><code>fromH5</code> has some additional parameters that contain some global parameters / state of the simulation. Those are the action, lattice, and random number generator. The evolver is allowed to store references to them and use them for evolution. Since those objects are provided, they do not have to be saved by the evolver, thus avoiding duplication and reducing file size. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
